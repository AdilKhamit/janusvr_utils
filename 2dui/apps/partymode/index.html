<html lang="en">
<head>
  <meta charset="utf-8">

  <title>JanusVR Interface</title>
  <meta name="description" content="JanusVR Interface">
  <meta name="author" content="JanusVR Inc.">
  <script src="../../scripts/tabs.js"></script>
  
  <script>

  
    function launchPortal(url) {
  
  parent.window.janus.launchurl(url,0);
  
  }
  
  
function populatePartyObject() {
parent.window.janus.updatepartymodedata() 
}


var sitename;

  function createParties() {
  document.getElementById("partycontainer").innerHTML = "" //blank out the party container so we can refresh it with new data
  

  if (parent.window.janus.partymodedata.length > 0)
  {
	  var i;
	  for (i=0;i<parent.window.janus.partymodedata.length;i++)
	  {
		var newelement=document.createElement("div");
		newelement.className="partyitem";
		
		if (parent.window.janus.partymodedata[i].name == null)
		{
		sitename = parent.window.janus.partymodedata[i].url
		}
		else
		{
		sitename = parent.window.janus.partymodedata[i].name
		}
		
		newelement.innerHTML = parent.window.janus.partymodedata[i].userId+" in <b>"+sitename+"</b>";
		newelement.onclick =  function(arg) {
										return function() {
											launchPortal(parent.window.janus.partymodedata[arg].url)
												}
												}(i);
												
		document.getElementById("partycontainer").appendChild(newelement);
	  
	  }
	}
	else
	{
	var newelement=document.createElement("div");
		newelement.className="partynobody";
	newelement.innerHTML = "<img style='width:128px;text-align:center;' src='search.png'></img><p>Searching for parties...</p>"
	document.getElementById("partycontainer").appendChild(newelement);	
	}
	
  
  
  }
  
  window.onload = function () {
  
  tabSelect("maintabcontainer","maintabbutton")
  window.onresize()
  document.getElementById("partytoggle").checked = parent.window.janus.getsetting('partymode');
  populatePartyObject()
  createParties();


  }


  
   window.onresize = function(event) { //make sure the window area stays a consistent size


 
 if (document.getElementById("tabrow").offsetWidth >= 200) //if you change the 200 here, also change the min-width of the window containing it. this is to prevent flicker when vertically resizing a minimally (width) sized window
 {
document.getElementById("windowarea").style.height = "calc(100% - "+(document.getElementsByClassName("tabrow")[0].offsetHeight+3)+"px)";	
 }
};

setInterval(function(){ populatePartyObject(); },15000) //update the list every 15 seconds   
setInterval(function(){   createParties(); }, 5000); //rebuild the list every five seconds 

    </script>
  
  
  <link rel="stylesheet" type="text/css" href="../../skins/emerald/emeraldgenericwindow.css">
  
</head>

<body >

<div class="windowcontainer">

<div class="tabrow unselectable" id="tabrow">

	<div class="tabbutton" id="maintabbutton" onmousedown="tabSelect('maintabcontainer','maintabbutton')">HOST</div></li>
	<div class="tabbutton" id="maintabbutton2" onmousedown="tabSelect('maintabcontainer2','maintabbutton2')">FIND</div></li>



</div>


<div class="windowarea unselectable" id="windowarea" style="background-image: url(../../backgrounds/stars.png);background-size:cover;background-attachment:fixed;" >
		
					
					
					
				<div class="tabcontainer" id="maintabcontainer" >
					<div style="text-align:center;">
					<p>Party Mode allows users<br>
					to easily find you from<br>
					anywhere in JanusVR.<br>
					<br>
					Bored or just looking to<br>
					spice up your browsing<br>
					experience?<br>
					<br>
					Check the box below<br>
					to start broadcasting in<br>
					Party Mode!</p>
					</div>


					<div class='item' style="background-color:545454;margin-top:32px;margin-bottom:32px;" >
					<span>
					<input class="myCheckbox" id="partytoggle" type='checkbox' onchange="window.janus.setsetting('partymode', this.checked); " > 
					Broadcast my location

					</span>
					<br>
					</div>



				</div>	

				<div class="tabcontainer" id="maintabcontainer2">	
						
						
							<div id="partycontainer"> 							
							<div class="partynobody"><img style='width:128px;text-align:center;' src='search.png'></img><p>Searching for parties...</p></div>
							</div>				

		
				</div>							
					
	
					
					
		</div>			


























		
</div>



</body>
</html>